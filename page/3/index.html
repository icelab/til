<!DOCTYPE html><html lang="en-au"><head><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><meta content="Today Icelab Learned" property="og:site_name" /><meta content="http://til.icelab.com.au/page/3/" property="og:url" /><meta content="article" property="og:type" /><meta content="A knowledgebase of little learnings from the team at Icelab." property="og:description" /><script>!function(o){function t(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return o[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var e={};return t.m=o,t.c=e,t.p="",t(0)}({0:function(o,t,e){o.exports=e(12)},11:function(o,t){window.localStorage.getItem("fontsLoaded")&&(window.document.documentElement.className+=" fonts-loaded")},12:function(o,t,e){e.p="/assets/",e(11)}});</script><link href="http://til.icelab.com.au/assets/public/favicon-fe80d575.png" rel="shortcut icon" /><link href="http://til.icelab.com.au/assets/public-8b27d484.css" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700:latin" rel="stylesheet" type="text/css" /><script async="" src="http://til.icelab.com.au/assets/public-49d86d77.js"></script><title>Today Icelab Learned</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', "UA-2193586-3", 'auto');
ga('send', 'pageview');</script><link href="/feed.xml" rel="alternate" title="Today Icelab Learned" type="application/atom+xml" /></head><body><aside class="sidebar" id="sidebar"><button class="close-sidebar" data-view-toggle-sidebar="">Hide topics &rsaquo; </button><div class="sidebar-topic"><a href="/topics/accessibility">accessibility</a><span class="topic-count"> (<i>2</i>)</span></div><div class="sidebar-topic"><a href="/topics/analytics">analytics</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/aws">aws</a><span class="topic-count"> (<i>3</i>)</span></div><div class="sidebar-topic"><a href="/topics/css">css</a><span class="topic-count"> (<i>3</i>)</span></div><div class="sidebar-topic"><a href="/topics/debugging">debugging</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/git">git</a><span class="topic-count"> (<i>3</i>)</span></div><div class="sidebar-topic"><a href="/topics/heroku">heroku</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/html">html</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/javascript">javascript</a><span class="topic-count"> (<i>4</i>)</span></div><div class="sidebar-topic"><a href="/topics/nginx">nginx</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/ops">ops</a><span class="topic-count"> (<i>2</i>)</span></div><div class="sidebar-topic"><a href="/topics/performance">performance</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/postgres">postgres</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/processing">processing</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/rails">rails</a><span class="topic-count"> (<i>4</i>)</span></div><div class="sidebar-topic"><a href="/topics/rake">rake</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/react">react</a><span class="topic-count"> (<i>2</i>)</span></div><div class="sidebar-topic"><a href="/topics/regex">regex</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/ruby">ruby</a><span class="topic-count"> (<i>13</i>)</span></div><div class="sidebar-topic"><a href="/topics/seo">seo</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/slim">slim</a><span class="topic-count"> (<i>1</i>)</span></div><div class="sidebar-topic"><a href="/topics/social">social</a><span class="topic-count"> (<i>2</i>)</span></div><div class="sidebar-topic"><a href="/topics/testing">testing</a><span class="topic-count"> (<i>1</i>)</span></div></aside><div class="header"><a class="header__logo" href="http://www.icelab.com.au"></a><a href="/" class="header__til-text">Today Icelab Learned</a><button class="header__view-topics open-sidebar" data-view-toggle-sidebar="">&lsaquo; <span>View</span> topics </button></div><div class="container"><div class="article"><h2 class="article__title"><a href="/using-arel-to-compare-attributes-of-a-record/">Using Arel to compare attributes of a&nbsp;record</a></h2><div class="article__meta">Daniel Nitsikopoulos, 24 September 2015</div><div class="article__content" data-view-highlight=""><p>I was just trying to find a way to run a query and compare the <code>updated_at</code> and <code>created_at</code> attributes of a record and came across this technique:</p>
<pre class="highlight ruby"><code><span class="n">users</span> <span class="o">=</span> <span class="no">User</span><span class="p">.</span><span class="nf">arel_table</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="ss">:created_at</span><span class="p">].</span><span class="nf">eq</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="ss">:updated_at</span><span class="p">]))</span>
</code></pre>

<p>It seems like <code>.gt</code> and <code>.lt</code> also work. While <code>User.where(&quot;created_at = updated_at&quot;)</code> would also work in SQL, we can use Arel to be database agnostic.</p>

<p><em><a href="https://github.com/rails/arel">Arel docs</a></em></p>
</div><div class="article__tags"><a href="/topics/rails" class="article__tag">rails</a></div></div><div class="article"><h2 class="article__title"><a href="/manually-incrementing-count-columns/">Manually incrementing count columns in&nbsp;rails</a></h2><div class="article__meta">Daniel Nitsikopoulos, 18 September 2015</div><div class="article__content" data-view-highlight=""><p>Adding a counter cache column to a model is a common optimisation we make in order to avoid unnecessary queries when trying to aggregate data associated with that particular model. Rails provides us with a number of ways to maintain the counter cache column&rsquo;s value. The first is to follow the rails convention and add <code>counter_cache: true</code> to a <code>belongs_to</code> association and ensure we have a correctly named <code>*_count</code> column.</p>

<p>The other way to do it, is manually. In this case rails provides us with a few convenience methods to increment a given column.</p>

<p>The first is <code>ActiveRecord::Base#increment!(attribute, by)</code>.</p>

<p><code>increment!</code> is defined as:</p>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">increment!</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">increment</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">by</span><span class="p">).</span><span class="nf">update_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">self</span><span class="p">[</span><span class="n">attribute</span><span class="p">])</span>
<span class="k">end</span>
</code></pre>

<p>and <code>increment</code> is defined as:</p>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
  <span class="nb">self</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">||=</span> <span class="mi">0</span>
  <span class="nb">self</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+=</span> <span class="n">by</span>
  <span class="nb">self</span>
<span class="k">end</span>
</code></pre>

<p>Which means that we&rsquo;re first fetching the current attribute&rsquo;s value, incrementing it then passing it on to <code>update_attribute</code> before it can be saved. This method leads to a non-atomic database operation, that is to say that at one point, the count is different in memory than it is in the database (which can lead to race conditions).</p>

<p>The second is <code>ActiveRecord::Base#increment_counter(column_name, record_id)</code></p>

<p><code>increment_counter</code> is defined as:</p>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">increment_counter</span><span class="p">(</span><span class="n">counter_name</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
  <span class="n">update_counters</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">counter_name</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>

<p>which executes SQL like:</p>
<pre class="highlight sql"><code><span class="k">UPDATE</span> <span class="nv">"table_name"</span>
  <span class="k">SET</span> <span class="nv">"counter_name"</span> <span class="o">=</span> <span class="nv">"counter_name"</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">WHERE</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre>

<p>This means that we now have an atomic operation and the counter cache value is the same across the system.</p>

<p>Docs:</p>

<ul>
<li><a href="http://apidock.com/rails/ActiveRecord/Base/increment!">increment!</a></li>
<li><a href="http://apidock.com/rails/ActiveRecord/Base/increment_counter/class">increment_counter</a></li>
</ul>
</div><div class="article__tags"><a href="/topics/rails" class="article__tag">rails</a><a href="/topics/ruby" class="article__tag">ruby</a></div></div><div class="article"><h2 class="article__title"><a href="/setting-cookies-in-request-specs/">Setting cookies in request&nbsp;specs</a></h2><div class="article__meta">Narinda Reeders, 17 September 2015</div><div class="article__content" data-view-highlight=""><p>When writing request specs and you want to set a cookie, setting it with Capybara doesn’t seem to work, best to set it in the request headers.</p>

<p>Sad panda:</p>
<pre class="highlight ruby"><code><span class="no">Capybara</span><span class="p">.</span><span class="nf">current_session</span><span class="p">.</span><span class="nf">driver</span><span class="p">.</span><span class="nf">browser</span><span class="p">.</span><span class="nf">set_cookie</span><span class="p">(</span><span class="s2">"really_useful_cookie=</span><span class="si">#{</span><span class="n">cookie_monster</span><span class="p">.</span><span class="nf">id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre>

<p>Happy panda:</p>
<pre class="highlight ruby"><code><span class="n">get</span> <span class="n">some_path</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{</span><span class="s2">"HTTP_COOKIE"</span> <span class="o">=&gt;</span> <span class="s2">"really_useful_cookie=</span><span class="si">#{</span><span class="n">cookie_monster</span><span class="p">.</span><span class="nf">id</span><span class="si">}</span><span class="s2">”}
</span></code></pre>
</div><div class="article__tags"><a href="/topics/testing" class="article__tag">testing</a></div></div><div class="article"><h2 class="article__title"><a href="/using-viewloader-with-turbolinks/">Using viewloader with&nbsp;turbolinks</a></h2><div class="article__meta">Andrew Croome, 17 September 2015</div><div class="article__content" data-view-highlight=""><p>When using viewloader with turbolinks, you want to make sure that viewloader executes once on the initial page load, once when the visitor reaches another page, and once when the visitor goes back in their browser (or forward for that matter).</p>

<p>To achieve this, get viewloader to execute on the <code>ready</code>, <code>page:load</code> and <code>page:restore</code> events:</p>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">"ready page:load page:restore"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">viewloader</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">views</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>

<p><code>page:restore</code> is fired by <a href="https://github.com/rails/turbolinks">turbolinks</a> whenever &ldquo;A cached body element has been loaded into the DOM&rdquo;.</p>
</div><div class="article__tags"><a href="/topics/javascript" class="article__tag">javascript</a></div></div><div class="article"><h2 class="article__title"><a href="/postgres-listen-notify/">PostgreSQL as a message&nbsp;bus</a></h2><div class="article__meta">Alex Timofeev, 15 September 2015</div><div class="article__content" data-view-highlight=""><p>PostgreSQL has its own listen/notify mechanism. It might be useful for cases when we have to manage messaging between different application processes, but would prefer to not use extra dependencies such as Redis.</p>

<p><em>process.rb</em></p>
<pre class="highlight ruby"><code><span class="no">CHANNEL</span>       <span class="o">=</span> <span class="s2">"slack_bot"</span>
<span class="no">RESET_CHANNEL</span> <span class="o">=</span> <span class="s2">"pg_restart"</span>

<span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">connection_pool</span><span class="p">.</span><span class="nf">with_connection</span> <span class="k">do</span> <span class="o">|</span><span class="n">connection</span><span class="o">|</span>
  <span class="n">conn</span> <span class="o">=</span> <span class="n">connection</span><span class="p">.</span><span class="nf">instance_variable_get</span><span class="p">(</span><span class="ss">:@connection</span><span class="p">)</span>
  <span class="k">begin</span>
    <span class="n">conn</span><span class="p">.</span><span class="nf">async_exec</span> <span class="s2">"LISTEN </span><span class="si">#{</span><span class="no">RESET_CHANNEL</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">conn</span><span class="p">.</span><span class="nf">async_exec</span> <span class="s2">"LISTEN </span><span class="si">#{</span><span class="no">CHANNEL</span><span class="si">}</span><span class="s2">"</span>
    <span class="kp">catch</span><span class="p">(</span><span class="ss">:break_loop</span><span class="p">)</span> <span class="k">do</span>
      <span class="kp">loop</span> <span class="k">do</span>
        <span class="n">conn</span><span class="p">.</span><span class="nf">wait_for_notify</span> <span class="k">do</span> <span class="o">|</span><span class="n">channel</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">payload</span><span class="o">|</span>
          <span class="nb">p</span> <span class="p">[</span><span class="n">channel</span><span class="p">,</span> <span class="n">payload</span><span class="p">]</span>
          <span class="kp">throw</span> <span class="ss">:break_loop</span> <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="no">RESET_CHANNEL</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">error</span>
    <span class="nb">p</span> <span class="p">[</span><span class="ss">:error</span><span class="p">,</span> <span class="n">error</span><span class="p">]</span>
  <span class="k">ensure</span>
    <span class="n">conn</span><span class="p">.</span><span class="nf">async_exec</span> <span class="s2">"UNLISTEN *"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p><em>another-process.rb</em></p>
<pre class="highlight ruby"><code><span class="no">User</span><span class="p">.</span><span class="nf">connection</span><span class="p">.</span><span class="nf">execute</span> <span class="sx">%Q(NOTIFY "slack_bot", params)</span>
</code></pre>
</div><div class="article__tags"><a href="/topics/rails" class="article__tag">rails</a><a href="/topics/postgres" class="article__tag">postgres</a></div></div><div class="article"><h2 class="article__title"><a href="/manually-add-sitemaps-to-googles-webmaster-tools/">Manually add sitemaps to Google’s Webmaster&nbsp;Tools</a></h2><div class="article__meta">Max Wheeler, 15 September 2015</div><div class="article__content" data-view-highlight=""><p>It’s good practice to add sitemaps to <a href="https://www.google.com/webmasters/tools/">Google’s Webmaster Tools</a> so you can check their health and get notifications about sitemap issues. We often host sitemaps on S3 because they could be large static files that we don’t want running through our Rails stack.</p>

<p>This leads us to the problem: If you have a sitemap that’s hosted externally to your website, you can’t add them through the Google’s Webmaster Tools interface. For some reason Google limits these to paths underneath the official domain attached to an account. There is a solution though — you can sneak them in using their notification URL. All you need to do is:</p>
<pre class="highlight plaintext"><code>curl www.google.com/webmasters/tools/ping?sitemap=https%3A%2F%2Fwheeler-centre-heracles.s3.amazonaws.com%2Fsitemaps%2Fsitemap.xml.gz
</code></pre>

<p>And ta da, it’ll show up in the Webmaster Tools admin interface.</p>
</div><div class="article__tags"><a href="/topics/seo" class="article__tag">seo</a></div></div><div class="article"><h2 class="article__title"><a href="/pushing-all-branches/">Pushing all&nbsp;branches</a></h2><div class="article__meta">Jojo Hall, 02 September 2015</div><div class="article__content" data-view-highlight=""><p>Say you want to push up an existing repository to a new remote on your favourite repository hosting service. You can use the following command if you want to make sure you include all branches:</p>
<pre class="highlight plaintext"><code>git push &lt;REMOTE-NAME&gt; --all
</code></pre>

<p>This is especially helpful when you want to immediately create some PRs!</p>

<p>To push all tags:</p>
<pre class="highlight plaintext"><code>git push &lt;REMOTE-NAME&gt; --tags
</code></pre>
</div><div class="article__tags"><a href="/topics/git" class="article__tag">git</a></div></div><div class="article"><h2 class="article__title"><a href="/show-opengraph-image-on-first-facebook-share/">Show Open Graph image on first Facebook&nbsp;share</a></h2><div class="article__meta">Max Wheeler, 02 September 2015</div><div class="article__content" data-view-highlight=""><p>When you share a URL on Facebook for the first time — specifically, the first time <em>anyone</em> has shared it — it won’t include any of the images on the page and our clients will be :cry:. This happens even if you have included a meta tag that references an image:</p>
<pre class="highlight html"><code><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"http://foo.com/image.png"</span><span class="nt">&gt;</span>
</code></pre>

<p>The <em>second</em> time a URL is shared, it’ll work as expected and your chosen <code>og:image</code> will show up in the share preview (along with any other images on the page) — Facebook seem to have shifted this all to a background job or something.</p>

<p>Fear not! There is a solution. If you include the dimensions of your image alongside the <code>og:image</code> meta tag it’ll force Facebook to show the image immediately:</p>
<pre class="highlight html"><code><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"http://foo.com/image.png"</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image:width"</span> <span class="na">content=</span><span class="s">"300"</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image:height"</span> <span class="na">content=</span><span class="s">"400"</span><span class="nt">&gt;</span>
</code></pre>

<p>These dimensions don’t actually have to be accurate either. On Readings we don’t know the dimensions of images as they’re provided by Erudite without any meta-information, so we do a best-guess approach based on the ratio that book covers (or CD covers) tend to be.</p>
</div><div class="article__tags"><a href="/topics/social" class="article__tag">social</a></div></div><div class="article"><h2 class="article__title"><a href="/clear-facebook-share-data/">Facebook image display when posting a&nbsp;link</a></h2><div class="article__meta">Jess Allison, 20 August 2015</div><div class="article__content" data-view-highlight=""><p>When sharing links to Facebook, ████████ were only being given the option to display old images, and couldn’t work out why the new ones weren’t coming through.</p>

<p>As it happens, there are specific metatags required to force Facebook to notice the correct content, explained <a href="https://developers.facebook.com/docs/sharing/webmasters#markup">here</a>.</p>

<p>“Without these tags, the Facebook Crawler will use internal heuristics to make a best guess about the title, description, and preview image for your content.”</p>

<p>To force refresh of a particular item without updating the site itself, you can also use the <a href="https://developers.facebook.com/tools/debug/og/object/">Facebook debugger</a>.</p>

<p>If you go there, input the URL and click “Fetch new scrape information” until the “right” content shows up at the bottom.</p>
</div><div class="article__tags"><a href="/topics/social" class="article__tag">social</a></div></div><div class="article"><h2 class="article__title"><a href="/css-dropdown-menus/">CSS dropdown&nbsp;menus</a></h2><div class="article__meta">Andy McCray, 17 August 2015</div><div class="article__content" data-view-highlight=""><p>Creating a CSS-only dropdown menu is easy!</p>

<p><img src="http://til.icelab.com.au/assets/public/content/css-dropdown-menus-65627d09.gif" alt="CSS dropdown menus are the bomb" /></p>

<p>Using nested lists, the basic structure is:</p>
<pre class="highlight slim"><code><span class="nt">ul</span><span class="nc">.nav</span>
  <span class="nt">li</span><span class="nc">.nav__list-item</span>
    <span class="nt">a</span><span class="nc">.nav__list-anchor</span><span class="w"> </span><span class="na">href</span><span class="p">=</span><span class="s">"#"</span>
      <span class="p">|</span> Hogwarts
  <span class="nt">li</span><span class="nc">.nav__list-item.nav__list-item--has-dropdown</span>
    <span class="nt">span</span><span class="nc">.nav__list-toggle</span>
      <span class="p">|</span> Students
      <span class="nt">i</span><span class="nc">.fa.fa-caret-down</span>
    <span class="nt">ul</span><span class="nc">.nav__dropdown</span>
      <span class="nt">li</span><span class="nc">.nav__dropdown-list-item</span>
        <span class="nt">a</span><span class="nc">.nav__dropdown-list-anchor</span><span class="w"> </span><span class="na">href</span><span class="p">=</span><span class="s">"#"</span>
          <span class="p">|</span> Harry Potter
      <span class="nt">li</span><span class="nc">.nav__dropdown-list-item</span>
        <span class="nt">a</span><span class="nc">.nav__dropdown-list-anchor</span><span class="w"> </span><span class="na">href</span><span class="p">=</span><span class="s">"#"</span>
          <span class="p">|</span> Ron Weasley
      <span class="nt">li</span><span class="nc">.nav__dropdown-list-item</span>
        <span class="nt">a</span><span class="nc">.nav__dropdown-list-anchor</span><span class="w"> </span><span class="na">href</span><span class="p">=</span><span class="s">"#"</span>
          <span class="p">|</span> Hermione Granger
  <span class="nt">li</span><span class="nc">.nav__list-item.nav__list-item--has-dropdown</span>
    <span class="nt">span</span><span class="nc">.nav__list-toggle</span>
      <span class="p">|</span> Teachers
      <span class="nt">i</span><span class="nc">.fa.fa-caret-down</span>
    <span class="nt">ul</span><span class="nc">.nav__dropdown</span>
      <span class="nt">li</span><span class="nc">.nav__dropdown-list-item</span>
        <span class="nt">a</span><span class="nc">.nav__dropdown-list-anchor</span><span class="w"> </span><span class="na">href</span><span class="p">=</span><span class="s">"#"</span>
          <span class="p">|</span> Minerva McGonagall
      <span class="nt">li</span><span class="nc">.nav__dropdown-list-item</span>
        <span class="nt">a</span><span class="nc">.nav__dropdown-list-anchor</span><span class="w"> </span><span class="na">href</span><span class="p">=</span><span class="s">"#"</span>
          <span class="p">|</span> Severus Snape
</code></pre>

<p>And the bare-bones CSS:</p>
<pre class="highlight css"><code><span class="nc">.nav__list-item</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
<span class="p">}</span>

  <span class="nc">.nav__list-anchor</span><span class="o">,</span>
  <span class="nc">.nav__list-toggle</span> <span class="p">{</span>
    <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
  <span class="p">}</span>

    <span class="nc">.nav__dropdown</span> <span class="p">{</span>
      <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
      <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
      <span class="nl">z-index</span><span class="p">:</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nc">.nav__list-item--has-dropdown</span><span class="nd">:hover</span> <span class="nc">.nav__dropdown</span><span class="o">,</span>
    <span class="nc">.nav__list-item--has-dropdown</span><span class="nd">:focus</span> <span class="nc">.nav__dropdown</span> <span class="p">{</span>
      <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    <span class="p">}</span>

      <span class="nc">.nav__dropdown-list-anchor</span> <span class="p">{</span>
        <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
      <span class="p">}</span>
</code></pre>

<h2 id="consider-mobile">Consider mobile</h2>

<p><code>:hover</code> triggered menus don&rsquo;t feel <em>great</em> on mobile. A nice solution is to use a JavaScript <code>click</code> event to append a modifier class to the the toggle element (<code>.nav__list-anchor--dropdown-is-visible</code>) and use that class to perma-show the menu.</p>
</div><div class="article__tags"><a href="/topics/css" class="article__tag">css</a></div></div><div class="pagination"><a href="/page/2/" class="pagination__newer">&lsaquo; Newer</a><a href="/page/4/" class="pagination__older">Older &rsaquo;</a></div></div><div class="footer">A knowledgebase of little learnings from the team at Icelab. <a href="https://github.com/icelab/til/">Source on GitHub</a>.</div><script>!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(10)},,,,,,,function(t,e){!function(){function e(t,e){r?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function n(t){document.body?t():r?document.addEventListener("DOMContentLoaded",t):document.attachEvent("onreadystatechange",function(){"interactive"!=document.readyState&&"complete"!=document.readyState||t()})}function i(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function o(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+e+";"}function a(t){var e=t.a.offsetWidth,n=e+100;return t.f.style.width=n+"px",t.c.scrollLeft=n,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e?(t.g=e,!0):!1}function l(t,n){function i(){var t=o;a(t)&&null!==t.a.parentNode&&n(t.g)}var o=t;e(t.b,i),e(t.c,i),a(t)}function s(t,e){var n=e||{};this.family=t,this.style=n.style||"normal",this.weight=n.weight||"normal",this.stretch=n.stretch||"normal"}function c(){if(null===f){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(e){}f=""!==t.style.font}return f}function d(t,e){return[t.style,t.weight,c()?t.stretch:"","100px",e].join(" ")}var r=!!document.addEventListener,h=null,f=null,m=!!window.FontFace;s.prototype.load=function(t,e){var a=this,s=t||"BESbswy",c=e||3e3,r=(new Date).getTime();return new Promise(function(t,e){if(m){var f=new Promise(function(t,e){function n(){(new Date).getTime()-r>=c?e():document.fonts.load(d(a,a.family),s).then(function(e){1<=e.length?t():setTimeout(n,25)},function(){e()})}n()}),u=new Promise(function(t,e){setTimeout(e,c)});Promise.race([u,f]).then(function(){t(a)},function(){e(a)})}else n(function(){function n(){var e;(e=-1!=w&&-1!=y||-1!=w&&-1!=v||-1!=y&&-1!=v)&&((e=w!=y&&w!=v&&y!=v)||(null===h&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),h=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=h&&(w==g&&y==g&&v==g||w==x&&y==x&&v==x||w==b&&y==b&&v==b)),e=!e),e&&(null!==T.parentNode&&T.parentNode.removeChild(T),clearTimeout(E),t(a))}function f(){if((new Date).getTime()-r>=c)null!==T.parentNode&&T.parentNode.removeChild(T),e(a);else{var t=document.hidden;!0!==t&&void 0!==t||(w=m.a.offsetWidth,y=u.a.offsetWidth,v=p.a.offsetWidth,n()),E=setTimeout(f,50)}}var m=new i(s),u=new i(s),p=new i(s),w=-1,y=-1,v=-1,g=-1,x=-1,b=-1,T=document.createElement("div"),E=0;T.dir="ltr",o(m,d(a,"sans-serif")),o(u,d(a,"serif")),o(p,d(a,"monospace")),T.appendChild(m.a),T.appendChild(u.a),T.appendChild(p.a),document.body.appendChild(T),g=m.a.offsetWidth,x=u.a.offsetWidth,b=p.a.offsetWidth,f(),l(m,function(t){w=t,n()}),o(m,d(a,'"'+a.family+'",sans-serif')),l(u,function(t){y=t,n()}),o(u,d(a,'"'+a.family+'",serif')),l(p,function(t){v=t,n()}),o(p,d(a,'"'+a.family+'",monospace'))})})},window.FontFaceObserver=s,window.FontFaceObserver.prototype.check=window.FontFaceObserver.prototype.load=s.prototype.load,"undefined"!=typeof t&&(t.exports=window.FontFaceObserver)}()},,function(t,e,n){function i(t){var e=window.localStorage.getItem("fontsLoaded");if(!e){var n=[];t.forEach(function(t){var e=new window.FontFaceObserver(t.family,{weight:t.weight,style:t.style});n.push(e.check())}),Promise.all(n).then(function(){window.document.documentElement.className+=" fonts-loaded",window.localStorage.setItem("fontsLoaded",!0)})}}n(7);var o=[{family:"National",style:"normal",weight:"normal"},{family:"National",style:"italic",weight:"normal"},{family:"National",style:"italic",weight:"bold"},{family:"National",style:"italic",weight:"bold"},{family:"TiemposText",style:"normal",weight:"normal"},{family:"TiemposText",style:"italic",weight:"normal"},{family:"TiemposText",style:"italic",weight:"bold"},{family:"TiemposText",style:"italic",weight:"bold"},{family:"Inconsolata",style:"normal",weight:"400"},{family:"Inconsolata",style:"italic",weight:"400"}];i(o)},function(t,e,n){n.p="/assets/",n(9)}]);</script></body></html>